<?xml version="1.0" encoding="UTF-8" ?>
<elementDefinition
  xmlns="NS:DEF"
  xmlns:svg="http://www.w3.org/2000/svg"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  xmlns:g="NS:GET">

<!-- TODO: Octave numbers obove/below --> 

<element name="clef">
  <properties>
    <elementReference name="start" lacuna=".."/>
    
    <coordinate name="x" anchor="g:x(g:start(.))" lacuna="0"/>
    <coordinate name="y" anchor="g:y(..)" lacuna="0"/>
    
    <coordinate name="x1" anchor="g:x(.)" lacuna="0"/>
    <!-- TODO: x2 should be calculated from the symbol width, something like
      ?x + ?size * document('../../symbol-library/lib.svg')/key('id',?symbol)/?x2
      How can we store the metadata with the symbols? Should we use getters
      or can we simply rely on attributes (preferable)?
      Analogously, x1, y1 and y2 should be calculated.
    -->
    <coordinate name="x2" anchor="g:x(.)" lacuna="0"/>
    <coordinate name="y1" anchor="g:y(.)" lacuna="0"/>
    <coordinate name="y2" anchor="g:y(.)" lacuna="0"/>
    
    <scaleFactor name="size" anchor="g:size(..)" lacuna="1"/>
    
    <symbol name="symbol" lacuna="clef.G"/>
    
<!--    <coordinate name="bb.left" anchor="0" lacuna="g:bb.left(g:symbol(.),musx:*) * g:size(.)"/>
    <coordinate name="bb.right" anchor="0" lacuna="g:bb.right(g:symbol(.),musx:*) * g:size(.)"/>
    <coordinate name="bb.top" anchor="0" lacuna="g:bb.top(g:symbol(.),musx:*) * g:size(.)"/>
    <coordinate name="bb.bottom" anchor="0" lacuna="g:bb.bottom(g:symbol(.),musx:*) * g:size(.)"/>
-->    
  </properties>
  
  <draw>
    <svg:use transform="translate({g:x(.)},{g:y(.)}) scale({g:size(.)})"
      xlink:href="{g:symbol(.)}"/>
  </draw>

</element>
  
</elementDefinition>